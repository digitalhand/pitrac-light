@startuml
title PiTrac Camera 1 Calibration Flow

skinparam shadowing false
skinparam backgroundColor white
skinparam activity {
  BackgroundColor #F8F9FA
  BorderColor #333333
  ArrowColor #333333
  FontColor #111111
}

start

:User runs calibration script:\nrunAutoCalibrateCam1.sh\nor: pitrac-cli run --mode camera1AutoCalibrate;

:Script sources runPiTracCommon.sh\nto load PITRAC_* environment variables;

:Spawns pitrac_lm\n--system_mode camera1AutoCalibrate\n--search_center_x 750 --search_center_y 500\n--artifact_save_level=all;

:pitrac_lm performs auto-calibration:\n- Detects calibration target\n- Computes kCamera1FocalLength\n- Computes kCamera1Angles;

if (Calibration successful?) then (yes)
  :Write calibration results\ninto golf_sim_config.json;
  :Save calibration artifact images\nto ~/LM_Shares/Images;
else (no)
  :Log error and exit with\nnon-zero status;
endif

:Process exits;

:User validates calibration images\nin ~/LM_Shares/Images;

stop
@enduml
